# CMS-Orbit Video Package

CMS-Orbitì„ ìœ„í•œ í¬ê´„ì ì¸ ë¹„ë””ì˜¤ ì—…ë¡œë“œ, ì¸ì½”ë”©, ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ë‹¤ì¤‘ í”„ë¡œíŒŒì¼ ì¸ì½”ë”©, ì¸ë„¤ì¼ ìƒì„±, ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ìƒì„±, HLS ìŠ¤íŠ¸ë¦¬ë°ì„ ì§€ì›í•©ë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

### ğŸ¥ ë¹„ë””ì˜¤ ê´€ë¦¬
- **ë‹¤ì¤‘ íŒŒì¼ ì—…ë¡œë“œ**: ì—¬ëŸ¬ ë¹„ë””ì˜¤ íŒŒì¼ì„ ë™ì‹œì— ì—…ë¡œë“œ
- **ìë™ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ**: ë¹„ë””ì˜¤ í•´ìƒë„, í”„ë ˆì„ë ˆì´íŠ¸, ë¹„íŠ¸ë ˆì´íŠ¸ ë“± ìë™ ë¶„ì„
- **ì§„í–‰ë¥  ì¶”ì **: ì‹¤ì‹œê°„ ì—…ë¡œë“œ ë° ì¸ì½”ë”© ì§„í–‰ë¥  ëª¨ë‹ˆí„°ë§
- **ì—ëŸ¬ ì²˜ë¦¬**: ìƒì„¸í•œ ì—ëŸ¬ ë¡œê·¸ ë° ì¬ì‹œë„ ë©”ì»¤ë‹ˆì¦˜

### ğŸ”„ ìë™ ì¸ì½”ë”©
- **ë‹¤ì¤‘ í”„ë¡œíŒŒì¼ ì§€ì›**: 4K, FHD, HD, SD ë“± ë‹¤ì–‘í•œ í•´ìƒë„ë¡œ ìë™ ì¸ì½”ë”©
- **ì ì‘í˜• ë¹„íŠ¸ë ˆì´íŠ¸**: HLS ìŠ¤íŠ¸ë¦¬ë°ì„ ìœ„í•œ ABR ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ìƒì„±
- **ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬**: Queueë¥¼ í†µí•œ ë¹„ë™ê¸° ì¸ì½”ë”© ì²˜ë¦¬
- **ì§„í–‰ë¥  ëª¨ë‹ˆí„°ë§**: ì‹¤ì‹œê°„ ì¸ì½”ë”© ìƒíƒœ ë° ë¡œê·¸ í™•ì¸

### ğŸ–¼ï¸ ë¯¸ë””ì–´ ìƒì„±
- **ì¸ë„¤ì¼ ìƒì„±**: ìë™ ì¸ë„¤ì¼ ì¶”ì¶œ ë° ìµœì í™”
- **ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€**: ë¹„ë””ì˜¤ ìŠ¤í¬ëŸ¬ë¹™ì„ ìœ„í•œ ìŠ¤í”„ë¼ì´íŠ¸ ì‹œíŠ¸ ìƒì„±
- **ë‹¤ì–‘í•œ í¬ë§·**: JPEG, WebP ë“± ë‹¤ì–‘í•œ ì´ë¯¸ì§€ í¬ë§· ì§€ì›

### ğŸ›ï¸ ê´€ë¦¬ì ì¸í„°í˜ì´ìŠ¤
- **Orchid Platform í†µí•©**: CMS-Orbitì˜ ê´€ë¦¬ì íŒ¨ë„ê³¼ ì™„ë²½ í†µí•©
- **ì§ê´€ì ì¸ UI**: ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì—…ë¡œë“œ, ì‹¤ì‹œê°„ ì§„í–‰ë¥  í‘œì‹œ
- **ìƒì„¸í•œ ë¡œê·¸**: FFmpeg ëª…ë ¹ì–´, ì—ëŸ¬ ë¡œê·¸, ì¸ì½”ë”© ìƒíƒœ í™•ì¸
- **í”„ë¡œíŒŒì¼ ê´€ë¦¬**: ì»¤ìŠ¤í…€ ì¸ì½”ë”© í”„ë¡œíŒŒì¼ ì„¤ì •

## ì„¤ì¹˜

### Composerë¥¼ í†µí•œ ì„¤ì¹˜

```bash
composer require cms-orbit/video-field
```

### ì„œë¹„ìŠ¤ í”„ë¡œë°”ì´ë” ë“±ë¡

íŒ¨í‚¤ì§€ëŠ” ìë™ìœ¼ë¡œ ë“±ë¡ë˜ì§€ë§Œ, ìˆ˜ë™ìœ¼ë¡œ ë“±ë¡í•˜ë ¤ë©´ `config/app.php`ì— ì¶”ê°€í•˜ì„¸ìš”:

```php
'providers' => [
    // ...
    CmsOrbit\VideoField\VideoServiceProvider::class,
],
```

### ì„¤ì • íŒŒì¼ ë°œí–‰

```bash
php artisan vendor:publish --provider="CmsOrbit\VideoField\VideoServiceProvider" --tag="config"
```

### ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰

```bash
php artisan migrate
```

### ì–¸ì–´ íŒŒì¼ ë°œí–‰

```bash
php artisan vendor:publish --provider="CmsOrbit\VideoField\VideoServiceProvider" --tag="lang"
```

## í™˜ê²½ ì„¤ì •

`.env` íŒŒì¼ì— ë‹¤ìŒ ì„¤ì •ì„ ì¶”ê°€í•˜ì„¸ìš”:

```env
# ë¹„ë””ì˜¤ ì €ì¥ì†Œ ì„¤ì •
VIDEO_STORAGE_DISK=public
VIDEO_STORAGE_PATH=videos/{videoId}
VIDEO_THUMBNAILS_PATH=videos/{videoId}/thumbnails
VIDEO_SPRITES_PATH=videos/{videoId}/sprites

# FFmpeg ì„¤ì •
FFMPEG_BINARY_PATH=ffmpeg
FFPROBE_BINARY_PATH=ffprobe
FFMPEG_TIMEOUT=3600
FFMPEG_THREADS=12

# ì—…ë¡œë“œ ì„¤ì •
VIDEO_MAX_FILE_SIZE=5368709120  # 5GB
VIDEO_CHUNK_SIZE=1048576        # 1MB

# Queue ì„¤ì •
VIDEO_QUEUE_NAME=default
VIDEO_MAX_TRIES=3
VIDEO_RETRY_DELAY=300

# ì •ë¦¬ ì„¤ì •
VIDEO_AUTO_CLEANUP=true
VIDEO_TEMP_FILE_TTL=86400
VIDEO_FAILED_JOB_TTL=604800
```

## ì‚¬ìš©ë²•

### 1. ëª¨ë¸ì— HasVideos íŠ¸ë ˆì´íŠ¸ ì¶”ê°€

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use CmsOrbit\VideoField\Traits\HasVideos;

class Post extends Model
{
    use HasVideos;
    
    // ë¹„ë””ì˜¤ì™€ì˜ ê´€ê³„ëŠ” ìë™ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤
}
```

### 2. ê´€ë¦¬ì í™”ë©´ì—ì„œ ë¹„ë””ì˜¤ ê´€ë¦¬

ë¹„ë””ì˜¤ íŒ¨í‚¤ì§€ëŠ” ìë™ìœ¼ë¡œ Orchid Platformì— í†µí•©ë˜ì–´ ë‹¤ìŒ í™”ë©´ë“¤ì„ ì œê³µí•©ë‹ˆë‹¤:

- **ë¹„ë””ì˜¤ ëª©ë¡**: ëª¨ë“  ë¹„ë””ì˜¤ ëª©ë¡ ë° ìƒíƒœ í™•ì¸
- **ë¹„ë””ì˜¤ ì—…ë¡œë“œ**: ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ë¹„ë””ì˜¤ ì—…ë¡œë“œ
- **ë¹„ë””ì˜¤ í¸ì§‘**: ë©”íƒ€ë°ì´í„° ìˆ˜ì • ë° ì¸ì½”ë”© ì„¤ì •
- **ì¸ì½”ë”© ëª¨ë‹ˆí„°ë§**: ì‹¤ì‹œê°„ ì¸ì½”ë”© ì§„í–‰ë¥  ë° ë¡œê·¸ í™•ì¸

### 3. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë¹„ë””ì˜¤ ì‚¬ìš©

```php
// ë‹¨ì¼ ë¹„ë””ì˜¤ ê°€ì ¸ì˜¤ê¸°
$video = Video::find(1);

// ë¹„ë””ì˜¤ URL ê°€ì ¸ì˜¤ê¸°
$videoUrl = $video->getVideoUrl('FHD@30fps');
$thumbnailUrl = $video->getThumbnailUrl();
$spriteUrl = $video->getSpriteUrl();

// HLS ìŠ¤íŠ¸ë¦¬ë° URL
$hlsUrl = $video->getHlsUrl();
```

### 4. ê´€ê³„í˜• ëª¨ë¸ì—ì„œ ë¹„ë””ì˜¤ ì‚¬ìš©

```php
// Post ëª¨ë¸ì—ì„œ ë¹„ë””ì˜¤ ê°€ì ¸ì˜¤ê¸°
$post = Post::find(1);
$videos = $post->videos; // ëª¨ë“  ë¹„ë””ì˜¤
$mainVideo = $post->videos()->where('is_main', true)->first();

// ë¹„ë””ì˜¤ ì¶”ê°€
$post->videos()->attach($videoId, ['is_main' => true]);
```

## ê³ ê¸‰ ì„¤ì •

### ì»¤ìŠ¤í…€ ì¸ì½”ë”© í”„ë¡œíŒŒì¼

`config/orbit-video.php`ì—ì„œ ê¸°ë³¸ í”„ë¡œíŒŒì¼ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ìƒˆë¡œìš´ í”„ë¡œíŒŒì¼ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```php
'default_profiles' => [
    'Custom@60fps' => [
        'width' => 1920,
        'height' => 1080,
        'framerate' => 60,
        'bitrate' => '10M',
        'profile' => 'main',
        'level' => '4.1',
        'codec' => 'libx264',
    ],
],
```

### ëª¨ë¸ë³„ í”„ë¡œíŒŒì¼ ì„¤ì •

íŠ¹ì • ëª¨ë¸ì—ì„œë§Œ ì‚¬ìš©í•  í”„ë¡œíŒŒì¼ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```php
class Post extends Model
{
    use HasVideos;
    
    protected $videoProfiles = [
        'FHD@30fps' => [
            'width' => 1920,
            'height' => 1080,
            'framerate' => 30,
            'bitrate' => '8M',
            'profile' => 'main',
            'level' => '4.0',
            'codec' => 'libx264',
        ],
    ];
}
```

### Queue ì‘ì—… ëª¨ë‹ˆí„°ë§

```bash
# ì¸ì½”ë”© ì‘ì—… ì‹¤í–‰
php artisan video:encode {videoId}

# íŠ¹ì • í”„ë¡œíŒŒì¼ë¡œ ì¸ì½”ë”©
php artisan video:encode {videoId} --profile="FHD@30fps"

# ê°•ì œ ì¬ì¸ì½”ë”©
php artisan video:encode {videoId} --force
```

## API ì—”ë“œí¬ì¸íŠ¸

### ë¹„ë””ì˜¤ ì—…ë¡œë“œ

```http
POST /api/videos/upload
Content-Type: multipart/form-data

{
    "file": "video.mp4",
    "title": "My Video",
    "description": "Video description"
}
```

### ë¹„ë””ì˜¤ ì •ë³´ ì¡°íšŒ

```http
GET /api/videos/{id}
```

### ì¸ì½”ë”© ìƒíƒœ í™•ì¸

```http
GET /api/videos/{id}/encoding-status
```

## ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### videos í…Œì´ë¸”
- `id`: ë¹„ë””ì˜¤ ê³ ìœ  ID
- `title`: ë¹„ë””ì˜¤ ì œëª©
- `description`: ë¹„ë””ì˜¤ ì„¤ëª…
- `original_file_id`: ì›ë³¸ íŒŒì¼ ID (Attachment)
- `duration`: ë¹„ë””ì˜¤ ê¸¸ì´ (ì´ˆ)
- `original_width`: ì›ë³¸ í•´ìƒë„ ë„ˆë¹„
- `original_height`: ì›ë³¸ í•´ìƒë„ ë†’ì´
- `original_framerate`: ì›ë³¸ í”„ë ˆì„ë ˆì´íŠ¸
- `original_bitrate`: ì›ë³¸ ë¹„íŠ¸ë ˆì´íŠ¸
- `original_size`: ì›ë³¸ íŒŒì¼ í¬ê¸°
- `status`: ì²˜ë¦¬ ìƒíƒœ (pending, processing, completed, failed)
- `encoding_progress`: ì¸ì½”ë”© ì§„í–‰ë¥  (0-100)
- `created_at`, `updated_at`: ìƒì„±/ìˆ˜ì • ì‹œê°„

### video_profiles í…Œì´ë¸”
- `id`: í”„ë¡œíŒŒì¼ ID
- `name`: í”„ë¡œíŒŒì¼ ì´ë¦„
- `width`: í•´ìƒë„ ë„ˆë¹„
- `height`: í•´ìƒë„ ë†’ì´
- `framerate`: í”„ë ˆì„ë ˆì´íŠ¸
- `bitrate`: ë¹„íŠ¸ë ˆì´íŠ¸
- `profile`: H.264 í”„ë¡œíŒŒì¼
- `level`: H.264 ë ˆë²¨
- `codec`: ì½”ë±
- `is_active`: í™œì„±í™” ì—¬ë¶€

### video_encoding_logs í…Œì´ë¸”
- `id`: ë¡œê·¸ ID
- `video_id`: ë¹„ë””ì˜¤ ID
- `profile_id`: í”„ë¡œíŒŒì¼ ID
- `status`: ì¸ì½”ë”© ìƒíƒœ
- `progress`: ì§„í–‰ë¥ 
- `error_message`: ì—ëŸ¬ ë©”ì‹œì§€
- `ffmpeg_command`: FFmpeg ëª…ë ¹ì–´
- `started_at`: ì‹œì‘ ì‹œê°„
- `completed_at`: ì™„ë£Œ ì‹œê°„

## ë¬¸ì œ í•´ê²°

### FFmpeg ì„¤ì¹˜ í™•ì¸

```bash
# FFmpeg ë²„ì „ í™•ì¸
ffmpeg -version
ffprobe -version

# ì„¤ì¹˜ (Ubuntu/Debian)
sudo apt update
sudo apt install ffmpeg

# ì„¤ì¹˜ (macOS)
brew install ffmpeg

# ì„¤ì¹˜ (CentOS/RHEL)
sudo yum install epel-release
sudo yum install ffmpeg
```

### ê¶Œí•œ ë¬¸ì œ í•´ê²°

```bash
# ì €ì¥ì†Œ ë””ë ‰í† ë¦¬ ê¶Œí•œ ì„¤ì •
chmod -R 755 storage/app/public/videos
chown -R www-data:www-data storage/app/public/videos
```

### Queue ì‘ì—… í™•ì¸

```bash
# Queue ìƒíƒœ í™•ì¸
php artisan queue:work --queue=default

# ì‹¤íŒ¨í•œ ì‘ì—… í™•ì¸
php artisan queue:failed

# ì‹¤íŒ¨í•œ ì‘ì—… ì¬ì‹œë„
php artisan queue:retry all
```

## ì„±ëŠ¥ ìµœì í™”

### ì„œë²„ ìš”êµ¬ì‚¬í•­
- **CPU**: ë©€í‹°ì½”ì–´ í”„ë¡œì„¸ì„œ (ì¸ì½”ë”© ì„±ëŠ¥ì— ì¤‘ìš”)
- **RAM**: ìµœì†Œ 8GB (4K ë¹„ë””ì˜¤ ì²˜ë¦¬ ì‹œ 16GB ê¶Œì¥)
- **ì €ì¥ì†Œ**: SSD ê¶Œì¥ (ë¹ ë¥¸ I/O ì„±ëŠ¥)
- **ë„¤íŠ¸ì›Œí¬**: ê³ ì† ì¸í„°ë„· ì—°ê²° (ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ)

### ì„¤ì • ìµœì í™”

```php
// config/orbit-video.php
'ffmpeg' => [
    'threads' => 12, // CPU ì½”ì–´ ìˆ˜ì— ë§ê²Œ ì¡°ì •
    'timeout' => 7200, // 2ì‹œê°„ (ê¸´ ë¹„ë””ì˜¤ ì²˜ë¦¬ìš©)
],
```

## ë¼ì´ì„ ìŠ¤

MIT License

## ê¸°ì—¬í•˜ê¸°

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ [Issues](https://github.com/cms-orbit/video-field/issues) í˜ì´ì§€ì—ì„œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.

## ë³€ê²½ ë¡œê·¸

### v1.0.0
- ì´ˆê¸° ë¦´ë¦¬ìŠ¤
- ë¹„ë””ì˜¤ ì—…ë¡œë“œ ë° ì¸ì½”ë”© ê¸°ëŠ¥
- ë‹¤ì¤‘ í”„ë¡œíŒŒì¼ ì§€ì›
- ì¸ë„¤ì¼ ë° ìŠ¤í”„ë¼ì´íŠ¸ ìƒì„±
- HLS ìŠ¤íŠ¸ë¦¬ë° ì§€ì›
- Orchid Platform í†µí•©